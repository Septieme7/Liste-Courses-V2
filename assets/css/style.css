/* =============================================================
   COURSES MALIN · style.css
   Style mobile-first – HTML5 – Dark Mode – Thème dynamique
   Structure :
     1.  Variables CSS (tokens de design)
     2.  Reset & Base
     3.  Layout principal (header, content, nav)
     4.  Navigation bottom tab bar
     5.  Bouton flottant FAB
     6.  Vues (home / lists / settings)
     7.  Bloc Budget
     8.  Indicateur liste active
     9.  Carte du magasin
    10.  Barre de recherche
    11.  En-têtes de catégories
    12.  Lignes d'articles
    13.  État vide (empty state)
    14.  Barre de total
    15.  Grille de listes (cards) avec bouton caméra
    16.  Page Réglages
    17.  Overlay & Bottom Sheets
    18.  Composants partagés (stepper, chips, toggle, couleurs)
    19.  Modal Logo
    20.  Snackbar
    21.  Animations & Transitions
    22.  Responsive (≥ 640px)
============================================================= */

/* =============================================================
   1. VARIABLES CSS
============================================================= */
:root {
  /* --- Couleur primaire (thème "blue" par défaut) --- */
  --p:   #3B82F6;   /* Couleur principale (bleu par défaut) */
  --pd:  #2563EB;   /* Version plus foncée pour les interactions */

  /* --- Couleurs sémantiques --- */
  --ok:  #10B981;   /* Vert pour les soldes positifs (restant) */
  --err: #EF4444;   /* Rouge pour les erreurs/dépassements */
  --warn:#F59E0B;   /* Orange pour l'avertissement (barre ≥ 80%) */

  /* --- Surfaces & fonds (mode clair) --- */
  --bg:  #F8FAFC;   /* Fond général */
  --sur: #FFFFFF;   /* Surface (cartes, header, etc.) */
  --sur2:#F1F5F9;   /* Surface secondaire (légèrement grisée) */

  /* --- Texte (mode clair) --- */
  --tx:  #1E293B;   /* Texte principal */
  --tx2: #64748B;   /* Texte secondaire (moins important) */
  --tx3: #94A3B8;   /* Texte tertiaire (placeholders, icônes) */

  /* --- Bordures --- */
  --bd:  #E2E8F0;   /* Couleur des bordures */

  /* --- Effets --- */
  --sh:    0 2px 10px rgba(0, 0, 0, 0.07);   /* Ombre légère */
  --sh-lg: 0 8px 24px rgba(0, 0, 0, 0.10);   /* Ombre plus prononcée */

  /* --- Rayon --- */
  --r:    16px;     /* Rayon de base (grand) */
  --r-sm: 10px;     /* Rayon moyen */
  --r-xs:  8px;     /* Petit rayon */

  /* --- Hauteurs fixes --- */
  --hh: 56px;       /* Hauteur du header */
  --th: 60px;       /* Hauteur de la barre de navigation */

  /* --- Transition globale --- */
  --tr: 0.2s ease;  /* Transition rapide pour les changements d'état */

  /* --- Échelle de taille --- */
  --scale: 1;
}

/* --- Thèmes de couleur (data-color sur <html>) --- */
[data-color="blue"]   { --p: #3B82F6; --pd: #2563EB; }
[data-color="green"]  { --p: #10B981; --pd: #059669; }
[data-color="red"]    { --p: #EF4444; --pd: #DC2626; }
[data-color="purple"] { --p: #8B5CF6; --pd: #7C3AED; }
[data-color="orange"] { --p: #F59E0B; --pd: #D97706; }
[data-color="pink"]   { --p: #EC4899; --pd: #DB2777; }
[data-color="gold"]   { --p: #D97706; --pd: #B45309; }

/* --- Mode sombre (data-theme="dark" sur <html>) --- */
[data-theme="dark"] {
  --bg:  #0F172A;   /* Fond plus foncé */
  --sur: #1E293B;   /* Surfaces plus sombres */
  --sur2:#334155;   /* Surface secondaire */
  --tx:  #F1F5F9;   /* Texte clair */
  --tx2: #94A3B8;   /* Texte secondaire clair */
  --tx3: #475569;   /* Texte tertiaire */
  --bd:  #334155;   /* Bordures plus foncées */
  --sh:    0 2px 10px rgba(0, 0, 0, 0.35);   /* Ombre plus marquée */
  --sh-lg: 0 8px 24px rgba(0, 0, 0, 0.50);
}

/* =============================================================
   2. RESET & BASE
============================================================= */
*,
*::before,
*::after {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
  -webkit-tap-highlight-color: transparent;
}

html {
  background-color: var(--bg);
  -webkit-text-size-adjust: 100%;
  font-size: 16px; /* base, mais sera modulée par --scale sur body */
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text',
               'Segoe UI', system-ui, sans-serif;
  font-size: calc(1rem * var(--scale)); /* 1rem = 16px de base */
  line-height: 1.4;
  background: var(--bg);
  color: var(--tx);
  height: 100dvh;
  overflow: hidden;
  transition: background var(--tr), color var(--tr);
}

a   { color: var(--p); text-decoration: none; }
ul  { list-style: none; }
button { font-family: inherit; cursor: pointer; background: none; border: none; }
input, select, textarea { font-family: inherit; }

/* =============================================================
   3. LAYOUT PRINCIPAL
============================================================= */
#hdr {
  position: fixed;
  top: 0; left: 0; right: 0;
  height: calc(3.5rem * var(--scale)); /* 56px */
  background: var(--sur);
  border-bottom: 1px solid var(--bd);
  display: flex;
  align-items: center;
  padding: 0 calc(0.75rem * var(--scale)); /* 12px */
  gap: calc(0.5rem * var(--scale)); /* 8px */
  z-index: 100;
  box-shadow: var(--sh);
  transition: background var(--tr), border-color var(--tr);
}

.htitle-wrap {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: calc(0.4375rem * var(--scale)); /* 7px */
  min-width: 0;
  cursor: pointer;
}

.hlogo {
  width: calc(1.625rem * var(--scale)); /* 26px */
  height: calc(1.625rem * var(--scale));
  object-fit: contain;
  flex-shrink: 0;
  filter: drop-shadow(0 calc(0.0625rem * var(--scale)) calc(0.125rem * var(--scale)) rgba(0,0,0,0.15));
  transition: transform 0.1s;
}
.hlogo:active { transform: scale(0.9); }

#hdr h1 {
  font-size: calc(1.0625rem * var(--scale)); /* 17px */
  font-weight: 600;
  color: var(--tx);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.hbtn {
  width: calc(2.25rem * var(--scale)); /* 36px */
  height: calc(2.25rem * var(--scale));
  border-radius: 50%;
  background: transparent;
  color: var(--tx2);
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  transition: background var(--tr), color var(--tr);
}
.hbtn:hover,
.hbtn:focus-visible { background: var(--sur2); }

.hbtn.pri {
  background: var(--p);
  color: #fff;
}
.hbtn.pri:hover,
.hbtn.pri:focus-visible { background: var(--pd); }

#content {
  position: fixed;
  top: calc(3.5rem * var(--scale)); /* = hauteur header */
  bottom: calc(3.75rem * var(--scale)); /* = hauteur nav */
  left: 0; right: 0;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;
}

/* =============================================================
   4. NAVIGATION BOTTOM TAB BAR
============================================================= */
#nav {
  position: fixed;
  bottom: 0; left: 0; right: 0;
  height: calc(3.75rem * var(--scale)); /* 60px */
  background: var(--sur);
  border-top: 1px solid var(--bd);
  display: flex;
  z-index: 100;
  box-shadow: 0 calc(-0.125rem * var(--scale)) calc(0.5rem * var(--scale)) rgba(0, 0, 0, 0.05);
  padding-bottom: env(safe-area-inset-bottom);
  transition: background var(--tr), border-color var(--tr);
}

.tab {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: calc(0.1875rem * var(--scale)); /* 3px */
  border: none;
  background: transparent;
  color: var(--tx3);
  font-size: calc(0.625rem * var(--scale)); /* 10px */
  font-weight: 500;
  transition: color var(--tr);
}
.tab svg {
  width: calc(1.375rem * var(--scale)); /* 22px */
  height: calc(1.375rem * var(--scale));
  stroke-width: 1.75;
}
.tab.on  { color: var(--p); }
.tab:active { transform: scale(0.9); }

/* =============================================================
   5. BOUTON FLOTTANT (FAB)
============================================================= */
#fab {
  position: fixed;
  bottom: calc(3.75rem * var(--scale) + 1rem * var(--scale)); /* 60px + 16px */
  right: calc(1.125rem * var(--scale)); /* 18px */
  width: calc(3.375rem * var(--scale)); /* 54px */
  height: calc(3.375rem * var(--scale));
  border-radius: 50%;
  background: var(--p);
  color: #fff;
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 calc(0.25rem * var(--scale)) calc(1.125rem * var(--scale)) color-mix(in srgb, var(--p) 55%, transparent);
  z-index: 90;
  transition: background var(--tr), transform var(--tr), box-shadow var(--tr);
}
#fab { background-color: color-mix(in srgb, var(--p) 50%, transparent); }
#fab:hover   { background: var(--pd); }
#fab:active  { transform: scale(0.92); }
#fab.pulse   { animation: pulse 2s infinite; }

#fab-list {
  position: fixed;
  bottom: calc(3.75rem * var(--scale) + 1rem * var(--scale));
  right: calc(1.125rem * var(--scale));
  width: calc(3.375rem * var(--scale));
  height: calc(3.375rem * var(--scale));
  border-radius: 50%;
  background: var(--p);
  color: #fff;
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 calc(0.25rem * var(--scale)) calc(1.125rem * var(--scale)) color-mix(in srgb, var(--p) 55%, transparent);
  z-index: 90;
  transition: background var(--tr), transform var(--tr), box-shadow var(--tr);
}
#fab-list:hover { background: var(--pd); }
#fab-list:active { transform: scale(0.92); }
#fab-list.pulse { animation: pulse 2s infinite; }

/* =============================================================
   6. VUES
============================================================= */
.view { display: none; padding: calc(0.75rem * var(--scale)) calc(1rem * var(--scale)) calc(1rem * var(--scale)); }
.view.on { display: block; }

.vtitle {
  font-size: calc(1.375rem * var(--scale)); /* 22px */
  font-weight: 700;
  margin-bottom: calc(1rem * var(--scale));
  color: var(--tx);
}

.vhdr {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: calc(0.875rem * var(--scale)); /* 14px */
  flex-direction: column;
}
.vhdr h2 { font-size: calc(1.375rem * var(--scale)); font-weight: 700; color: var(--tx); }

.addbtn {
  display: flex;
  align-items: center;
  gap: calc(0.3125rem * var(--scale)); /* 5px */
  padding: calc(0.5rem * var(--scale)) calc(0.875rem * var(--scale)); /* 8px 14px */
  background: var(--p);
  color: #fff;
  border-radius: calc(1.25rem * var(--scale)); /* 20px */
  border: none;
  font-size: calc(0.8125rem * var(--scale)); /* 13px */
  font-weight: 600;
  transition: background var(--tr);
}
.addbtn:hover { background: var(--pd); }

/* =============================================================
   7. BLOC BUDGET
============================================================= */
.card {
  background: var(--sur);
  border-radius: calc(1rem * var(--scale)); /* 16px */
  box-shadow: var(--sh);
  overflow: hidden;
  margin-bottom: calc(0.75rem * var(--scale)); /* 12px */
  transition: background var(--tr);
}
.bcard { padding: calc(1rem * var(--scale)); } /* 16px */

.brow {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: calc(0.75rem * var(--scale)); /* 12px */
}
.btag {
  font-size: calc(0.75rem * var(--scale)); /* 12px */
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  color: var(--tx2);
}

.btotal { display: flex; align-items: baseline; gap: calc(0.1875rem * var(--scale)); /* 3px */ }
.btotal input {
  width: calc(4.75rem * var(--scale)); /* 76px */
  font-size: calc(1.25rem * var(--scale)); /* 20px */
  font-weight: 700;
  color: var(--p);
  border: none;
  background: transparent;
  text-align: right;
  -moz-appearance: textfield;
}
.btotal input::-webkit-outer-spin-button,
.btotal input::-webkit-inner-spin-button { -webkit-appearance: none; }
.btotal input:focus { outline: none; border-bottom: 2px solid var(--p); }
.btotal span { font-size: calc(1rem * var(--scale)); font-weight: 600; color: var(--tx2); }

.bstats { display: flex; gap: calc(0.75rem * var(--scale)); margin-bottom: calc(0.625rem * var(--scale)); } /* 12px 10px */
.bst {
  flex: 1;
  background: var(--sur2);
  border-radius: calc(0.625rem * var(--scale)); /* 10px */
  padding: calc(0.625rem * var(--scale)) calc(0.75rem * var(--scale)); /* 10px 12px */
}
.bst-lbl {
  font-size: calc(0.6875rem * var(--scale)); /* 11px */
  color: var(--tx2);
  margin-bottom: calc(0.1875rem * var(--scale)); /* 3px */
  text-transform: uppercase;
  letter-spacing: 0.3px;
}
.bst-val { font-size: calc(1rem * var(--scale)); font-weight: 700; transition: color var(--tr); }

.bst-val.ok  { color: var(--p); }
.bst-val.err { color: var(--err); }

.pbar {
  height: calc(0.375rem * var(--scale)); /* 6px */
  background: var(--sur2);
  border-radius: calc(0.1875rem * var(--scale)); /* 3px */
  overflow: hidden;
}
.pfill {
  height: 100%;
  background: var(--p);
  border-radius: calc(0.1875rem * var(--scale));
  transition: width 0.4s ease, background 0.3s;
}
.pfill.w { background: var(--warn); }
.pfill.e { background: var(--err);  }

.balert {
  display: none;
  align-items: center;
  gap: calc(0.375rem * var(--scale)); /* 6px */
  margin-top: calc(0.625rem * var(--scale)); /* 10px */
  background: #FEE2E2;
  color: var(--err);
  border-radius: calc(0.625rem * var(--scale)); /* 10px */
  padding: calc(0.5625rem * var(--scale)) calc(0.75rem * var(--scale)); /* 9px 12px */
  font-size: calc(0.8125rem * var(--scale)); /* 13px */
  font-weight: 600;
}
.balert.on { display: flex; }
[data-theme="dark"] .balert { background: #450a0a; }

/* =============================================================
   8. INDICATEUR LISTE ACTIVE
============================================================= */
.alist {
  display: flex;
  align-items: center;
  gap: calc(0.5rem * var(--scale)); /* 8px */
  background: var(--sur);
  border-radius: calc(1rem * var(--scale)); /* 16px */
  padding: calc(0.75rem * var(--scale)) calc(0.875rem * var(--scale)); /* 12px 14px */
  box-shadow: var(--sh);
  margin-bottom: calc(0.75rem * var(--scale)); /* 12px */
  transition: background var(--tr);
}
#aListIco { font-size: calc(1.625rem * var(--scale)); line-height: 1; flex-shrink: 0; }
.alist-info { flex: 1; min-width: 0; }
.alist-sub {
  font-size: calc(0.6875rem * var(--scale)); /* 11px */
  color: var(--tx3);
  margin-bottom: 1px;
  text-transform: uppercase;
  letter-spacing: 0.3px;
}
.alist-name {
  font-size: calc(0.9375rem * var(--scale)); /* 15px */
  font-weight: 600;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  color: var(--tx);
}

.alist-share {
  width: calc(2.125rem * var(--scale)); /* 34px */
  height: calc(2.125rem * var(--scale));
  border-radius: 50%;
  border: 1.5px solid var(--bd);
  background: transparent;
  color: var(--p);
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  transition: background var(--tr), border-color var(--tr);
}
.alist-share:hover {
  background: var(--sur2);
  border-color: var(--p);
}

.alist-chg {
  padding: calc(0.4375rem * var(--scale)) calc(0.8125rem * var(--scale)); /* 7px 13px */
  background: var(--sur2);
  border: none;
  border-radius: calc(1.25rem * var(--scale)); /* 20px */
  font-size: calc(0.8125rem * var(--scale)); /* 13px */
  color: var(--tx2);
  white-space: nowrap;
  flex-shrink: 0;
  transition: background var(--tr);
}
.alist-chg:hover { background: var(--bd); }

/* =============================================================
   9. CARTE DU MAGASIN
============================================================= */
#listMapContainer .card {
  padding: calc(0.75rem * var(--scale)); /* 12px */
  display: flex;
  flex-direction: column;
  gap: calc(0.5rem * var(--scale)); /* 8px */
}
#listMapContainer .sact-btn {
  padding: calc(0.3125rem * var(--scale)) calc(0.5rem * var(--scale)); /* 5px 8px */
  font-size: calc(1rem * var(--scale)); /* 16px */
  line-height: 1;
}
#mapThumb {
  max-width: 100%;
  max-height: calc(9.375rem * var(--scale)); /* 150px */
  border-radius: calc(0.5rem * var(--scale)); /* 8px */
  object-fit: contain;
  background: var(--sur2);
  cursor: pointer;
}

/* =============================================================
   10. BARRE DE RECHERCHE
============================================================= */
.sbar { position: relative; margin-bottom: calc(0.75rem * var(--scale)); } /* 12px */
.sbar svg {
  position: absolute;
  left: calc(0.75rem * var(--scale)); /* 12px */
  top: 50%;
  transform: translateY(-50%);
  color: var(--tx3);
  pointer-events: none;
  width: calc(1.125rem * var(--scale)); /* 18px */
  height: calc(1.125rem * var(--scale));
}
.sbar input {
  width: 100%;
  height: calc(2.5rem * var(--scale)); /* 40px */
  border-radius: calc(1.25rem * var(--scale)); /* 20px */
  border: none;
  background: var(--sur2);
  padding: 0 calc(1rem * var(--scale)) 0 calc(2.5rem * var(--scale)); /* 16px 40px */
  font-size: calc(0.9375rem * var(--scale)); /* 15px */
  color: var(--tx);
  transition: background var(--tr);
}
.sbar input::placeholder { color: var(--tx3); }
.sbar input:focus { outline: 2px solid var(--p); background: var(--sur); }

/* =============================================================
   11. EN-TÊTES DE CATÉGORIES
============================================================= */
.chdr {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: calc(0.4375rem * var(--scale)) calc(0.875rem * var(--scale)); /* 7px 14px */
  border-radius: calc(0.5rem * var(--scale)); /* 8px */
  font-size: calc(0.75rem * var(--scale)); /* 12px */
  font-weight: 700;
  letter-spacing: 0.5px;
  margin: calc(0.625rem * var(--scale)) 0 calc(0.25rem * var(--scale)); /* 10px 0 4px */
}
.chdr-count { font-size: calc(0.625rem * var(--scale)); opacity: 0.7; font-weight: 600; } /* 10px */

/* =============================================================
   12. LIGNES D'ARTICLES
============================================================= */
.irow {
  display: flex;
  align-items: center;
  gap: calc(0.625rem * var(--scale)); /* 10px */
  padding: calc(0.6875rem * var(--scale)) calc(0.875rem * var(--scale)); /* 11px 14px */
  border-bottom: 1px solid var(--bd);
  min-height: calc(3.375rem * var(--scale)); /* 54px */
  background: var(--sur);
  transition: background var(--tr);
  animation: slideIn 0.15s ease-out;
}
.irow:last-child { border-bottom: none; }
.irow.ckd .itxt { text-decoration: line-through; color: var(--tx3); }

.icheck {
  width: calc(1.5rem * var(--scale)); /* 24px */
  height: calc(1.5rem * var(--scale));
  border-radius: 50%;
  border: 2px solid var(--bd);
  background: transparent;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  transition: background var(--tr), border-color var(--tr);
}
.icheck.on {
  background: var(--p);
  border-color: var(--p);
}
.icheck svg { display: none; }
.icheck.on svg { display: block; }

.ibody { flex: 1; min-width: 0; cursor: pointer; }
.itxt  { font-size: calc(0.9375rem * var(--scale)); font-weight: 400; color: var(--tx); transition: color var(--tr); }
.imeta {
  font-size: calc(0.75rem * var(--scale)); /* 12px */
  color: var(--tx2);
  font-style: italic;
  margin-top: 1px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.iact { display: flex; align-items: center; gap: calc(0.25rem * var(--scale)); flex-shrink: 0; } /* 4px */

.qbtn {
  width: calc(1.625rem * var(--scale)); /* 26px */
  height: calc(1.625rem * var(--scale));
  border-radius: 50%;
  border: 1.5px solid var(--bd);
  background: transparent;
  color: var(--tx2);
  font-size: calc(1rem * var(--scale)); /* 16px */
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background var(--tr), border-color var(--tr), color var(--tr);
}
.qbtn:hover {
  background: var(--sur2);
  border-color: var(--p);
  color: var(--p);
}
.qnum {
  font-size: calc(0.8125rem * var(--scale)); /* 13px */
  font-weight: 700;
  min-width: calc(1.125rem * var(--scale)); /* 18px */
  text-align: center;
  color: var(--p);
}

.iprice {
  font-size: calc(0.8125rem * var(--scale)); /* 13px */
  font-weight: 500;
  color: var(--tx2);
  cursor: pointer;
  min-width: calc(2.75rem * var(--scale)); /* 44px */
  text-align: right;
}
.iprice input {
  width: calc(3.75rem * var(--scale)); /* 60px */
  border: none;
  border-bottom: 1.5px solid var(--p);
  background: transparent;
  text-align: right;
  font-size: calc(0.8125rem * var(--scale));
  color: var(--tx);
  -moz-appearance: textfield;
}
.iprice input::-webkit-outer-spin-button,
.iprice input::-webkit-inner-spin-button { -webkit-appearance: none; }
.iprice input:focus { outline: none; }

.idel {
  width: calc(1.75rem * var(--scale)); /* 28px */
  height: calc(1.75rem * var(--scale));
  border-radius: 50%;
  border: none;
  background: transparent;
  color: var(--tx3);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background var(--tr), color var(--tr);
}
.idel:hover,
.idel:active { background: #FEE2E2; color: var(--err); }

/* =============================================================
   13. ÉTAT VIDE
============================================================= */
.empty { text-align: center; padding: calc(3rem * var(--scale)) calc(1.5rem * var(--scale)); color: var(--tx3); } /* 48px 24px */
.empty svg {
  width: calc(4.25rem * var(--scale)); /* 68px */
  height: calc(4.25rem * var(--scale));
  margin-bottom: calc(0.875rem * var(--scale)); /* 14px */
  opacity: 0.3;
}
.empty h2  { font-size: calc(1.0625rem * var(--scale)); font-weight: 600; margin-bottom: calc(0.375rem * var(--scale)); color: var(--tx2); } /* 17px 6px */
.empty p   { font-size: calc(0.875rem * var(--scale)); line-height: 1.5; } /* 14px */

/* =============================================================
   14. BARRE DE TOTAL
============================================================= */
.tbar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  background: var(--sur);
  border-radius: calc(1rem * var(--scale)); /* 16px */
  padding: calc(0.6875rem * var(--scale)) calc(1rem * var(--scale)); /* 11px 16px */
  box-shadow: var(--sh);
  margin-bottom: calc(0.75rem * var(--scale)); /* 12px */
}
.tbar-lbl { font-size: calc(0.8125rem * var(--scale)); color: var(--tx2); } /* 13px */
.tbar-val { font-size: calc(0.9375rem * var(--scale)); font-weight: 700; color: var(--p); } /* 15px */

/* =============================================================
   15. GRILLE DE LISTES (Cards)
============================================================= */
.lgrid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: calc(0.5rem * var(--scale)); /* 8px */
}

.lcard {
  border-radius: calc(0.625rem * var(--scale)); /* 10px */
  overflow: hidden;
  background: var(--sur);
  box-shadow: var(--sh);
  cursor: pointer;
  transition: transform var(--tr), box-shadow var(--tr), background var(--tr);
  position: relative;
}
.lcard:hover   { box-shadow: var(--sh-lg); }
.lcard:active  { transform: scale(0.97); }
.lcard.sel     { outline: 2.5px solid var(--p); }

.lbanner {
  height: calc(4rem * var(--scale)); /* 64px */
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: calc(1.75rem * var(--scale)); /* 28px */
}
.linfo    { padding: calc(0.625rem * var(--scale)) calc(0.75rem * var(--scale)) calc(0.25rem * var(--scale)); } /* 10px 12px 4px */
.lname    { font-size: calc(0.875rem * var(--scale)); font-weight: 600; margin-bottom: calc(0.1875rem * var(--scale)); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; color: var(--tx); } /* 14px 3px */
.lstats   { font-size: calc(0.6875rem * var(--scale)); color: var(--tx2); } /* 11px */

.lprog  { height: calc(0.1875rem * var(--scale)); background: var(--sur2); margin: calc(0.4375rem * var(--scale)) 0 calc(0.375rem * var(--scale)); border-radius: 2px; overflow: hidden; } /* 3px 7px 6px */
.lprogf { height: 100%; border-radius: 2px; transition: width 0.3s ease; }

.lbtns { display: flex; gap: calc(0.3125rem * var(--scale)); padding: 0 calc(0.625rem * var(--scale)) calc(0.625rem * var(--scale)); justify-content: flex-end; } /* 5px 10px 10px */
.lbtn  {
  padding: calc(0.25rem * var(--scale)) calc(0.3125rem * var(--scale)); /* 4px 5px */
  border: none;
  border-radius: calc(0.5rem * var(--scale)); /* 8px */
  font-size: calc(0.6875rem * var(--scale)); /* 11px */
  background: var(--sur2);
  color: var(--tx2);
  transition: background var(--tr);
}
.lbtn:hover { background: var(--bd); }
.lbtn.danger { background: #FEE2E2; color: var(--err); }
.lbtn.map { background: var(--sur2); font-size: calc(0.875rem * var(--scale)); } /* 14px */
[data-theme="dark"] .lbtn.danger { background: #450a0a; }

/* =============================================================
   16. PAGE RÉGLAGES
============================================================= */
.ssec { margin-bottom: calc(1.25rem * var(--scale)); } /* 20px */
.stitle {
  font-size: calc(0.6875rem * var(--scale)); /* 11px */
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.7px;
  color: var(--tx2);
  padding: 0 calc(0.25rem * var(--scale)); /* 4px */
  margin-bottom: calc(0.5rem * var(--scale)); /* 8px */
}
.sgroup {
  background: var(--sur);
  border-radius: calc(1rem * var(--scale)); /* 16px */
  overflow: hidden;
  box-shadow: var(--sh);
}
.srow {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: calc(0.8125rem * var(--scale)) calc(1rem * var(--scale)); /* 13px 16px */
  border-bottom: 1px solid var(--bd);
}
.srow:last-child { border-bottom: none; }
.srow-col { flex-direction: column; align-items: flex-start; gap: calc(0.625rem * var(--scale)); } /* 10px */

.slbl { font-size: calc(0.9375rem * var(--scale)); color: var(--tx); } /* 15px */
.sbl-danger { color: var(--err); }

.sact-btn {
  padding: calc(0.4375rem * var(--scale)) calc(0.875rem * var(--scale)); /* 7px 14px */
  background: var(--p);
  color: #fff;
  border: none;
  border-radius: calc(1.25rem * var(--scale)); /* 20px */
  font-size: calc(0.8125rem * var(--scale)); /* 13px */
  font-weight: 500;
  text-decoration: none;
  display: inline-flex;
  align-items: center;
  transition: background var(--tr);
}
.sact-btn img {
  display: block;
  width: calc(5.9375rem * var(--scale)); /* 95px */
  height: calc(2.5rem * var(--scale)); /* 40px */
}
.sact-btn:hover { background: var(--pd); }
.sact-btn.sact-muted { background: var(--sur2); color: var(--tx2); }
.sact-btn.sact-muted:hover { background: var(--bd); }
.sact-btn.sact-danger { background: #FEE2E2; color: var(--err); }
.sact-btn.sact-danger:hover { background: #FECACA; }
[data-theme="dark"] .sact-btn.sact-danger { background: #450a0a; }

.ssel {
  padding: calc(0.4375rem * var(--scale)) calc(0.625rem * var(--scale)); /* 7px 10px */
  border-radius: calc(0.5rem * var(--scale)); /* 8px */
  border: 1.5px solid var(--bd);
  background: var(--sur2);
  color: var(--tx);
  font-size: calc(0.875rem * var(--scale)); /* 14px */
  transition: border-color var(--tr);
}
.ssel:focus { outline: none; border-color: var(--p); }

.app-version { font-size: calc(0.75rem * var(--scale)); color: var(--tx3); text-align: center; padding: calc(0.25rem * var(--scale)) 0 calc(0.5rem * var(--scale)); } /* 12px 4px 8px */

/* =============================================================
   17. OVERLAY & BOTTOM SHEETS
============================================================= */
#ovl {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.45);
  z-index: 200;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.25s;
}
#ovl.on { opacity: 1; pointer-events: all; }

.sheet {
  position: fixed;
  bottom: 0; left: 0; right: 0;
  background: var(--sur);
  border-radius: calc(1.25rem * var(--scale)) calc(1.25rem * var(--scale)) 0 0; /* 20px */
  z-index: 210;
  transform: translateY(100%);
  transition: transform 0.32s cubic-bezier(0.32, 0.72, 0, 1);
  max-height: 90dvh;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  box-shadow: var(--sh-lg);
}
.sheet.on { transform: translateY(0); }

.shandle {
  width: calc(2.375rem * var(--scale)); /* 38px */
  height: calc(0.25rem * var(--scale)); /* 4px */
  background: var(--bd);
  border-radius: 2px;
  margin: calc(0.75rem * var(--scale)) auto 0; /* 12px */
}
.stit {
  font-size: calc(1.0625rem * var(--scale)); /* 17px */
  font-weight: 600;
  text-align: center;
  padding: calc(0.625rem * var(--scale)) calc(1rem * var(--scale)) calc(1rem * var(--scale)); /* 10px 16px 16px */
  color: var(--tx);
}
.sbody { padding: 0 calc(1rem * var(--scale)) calc(2.5rem * var(--scale)); } /* 16px 40px */

.fld { margin-bottom: calc(1rem * var(--scale)); } /* 16px */
.fld label {
  display: block;
  font-size: calc(0.6875rem * var(--scale)); /* 11px */
  font-weight: 700;
  color: var(--tx2);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: calc(0.375rem * var(--scale)); /* 6px */
}

.hint {
  font-weight: 400;
  text-transform: none;
  letter-spacing: 0;
  color: var(--tx3);
  font-size: calc(0.625rem * var(--scale)); /* 10px */
}

.multi-hint {
  font-size: calc(0.75rem * var(--scale)); /* 12px */
  color: var(--p);
  margin-top: calc(0.3125rem * var(--scale)); /* 5px */
  font-weight: 500;
  min-height: calc(1rem * var(--scale)); /* 16px */
}

.fld input[type="text"],
.fld input[type="number"],
.fld select,
.fld textarea {
  width: 100%;
  padding: calc(0.6875rem * var(--scale)) calc(0.875rem * var(--scale)); /* 11px 14px */
  border: 1.5px solid var(--bd);
  border-radius: calc(0.625rem * var(--scale)); /* 10px */
  font-size: calc(1rem * var(--scale)); /* 16px */
  background: var(--sur);
  color: var(--tx);
  transition: border-color var(--tr);
  -webkit-appearance: none;
  appearance: none;
}
.fld input:focus,
.fld select:focus,
.fld textarea:focus { outline: none; border-color: var(--p); }
.fld textarea { height: calc(4.5rem * var(--scale)); resize: none; line-height: 1.5; } /* 72px */

.fld input[type="number"]::-webkit-outer-spin-button,
.fld input[type="number"]::-webkit-inner-spin-button { -webkit-appearance: none; }
.fld input[type="number"] { -moz-appearance: textfield; }

.emoji-input {
  width: calc(4rem * var(--scale)) !important; /* 64px */
  text-align: center !important;
  font-size: calc(1.375rem * var(--scale)) !important; /* 22px */
  padding: calc(0.5rem * var(--scale)) !important; /* 8px */
  margin-top: calc(0.375rem * var(--scale)); /* 6px */
  border-radius: calc(0.625rem * var(--scale)) !important; /* 10px */
}

.sbtn {
  width: 100%;
  padding: calc(0.8125rem * var(--scale)); /* 13px */
  border-radius: calc(0.625rem * var(--scale)); /* 10px */
  border: none;
  font-size: calc(1rem * var(--scale)); /* 16px */
  font-weight: 600;
  transition: background var(--tr), opacity var(--tr);
}
.sbtn.pri { background: var(--p); color: #fff; }
.sbtn.pri:hover { background: var(--pd); }
.sbtn.pri:disabled { opacity: 0.4; cursor: not-allowed; }

/* =============================================================
   18. COMPOSANTS PARTAGÉS
============================================================= */

.stepper { display: flex; align-items: center; gap: calc(1.25rem * var(--scale)); justify-content: center; padding: calc(0.25rem * var(--scale)) 0; } /* 20px 4px */
.stbtn {
  width: calc(2.75rem * var(--scale)); /* 44px */
  height: calc(2.75rem * var(--scale));
  border-radius: 50%;
  border: 2px solid var(--bd);
  background: transparent;
  font-size: calc(1.375rem * var(--scale)); /* 22px */
  font-weight: 700;
  color: var(--p);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background var(--tr), border-color var(--tr);
}
.stbtn:hover { background: var(--sur2); border-color: var(--p); }
.stbtn:active { transform: scale(0.92); }
.stval { font-size: calc(1.5rem * var(--scale)); font-weight: 700; min-width: calc(2.5rem * var(--scale)); text-align: center; color: var(--tx); } /* 24px 40px */

.chips {
  display: flex;
  gap: calc(0.5rem * var(--scale)); /* 8px */
  overflow-x: auto;
  padding: calc(0.25rem * var(--scale)) 0 calc(0.5rem * var(--scale)); /* 4px 8px */
  margin-bottom: calc(0.25rem * var(--scale)); /* 4px */
  scrollbar-width: none;
  -ms-overflow-style: none;
}
.chips::-webkit-scrollbar { display: none; }
.chip {
  padding: calc(0.4375rem * var(--scale)) calc(0.875rem * var(--scale)); /* 7px 14px */
  background: var(--sur2);
  border-radius: calc(1.25rem * var(--scale)); /* 20px */
  border: none;
  font-size: calc(0.875rem * var(--scale)); /* 14px */
  color: var(--tx);
  white-space: nowrap;
  flex-shrink: 0;
  transition: background var(--tr), color var(--tr);
}
.chip:hover  { background: var(--bd); }
.chip:active { background: var(--p); color: #fff; }

.tog {
  width: calc(3rem * var(--scale)); /* 48px */
  height: calc(1.75rem * var(--scale)); /* 28px */
  border-radius: calc(0.875rem * var(--scale)); /* 14px */
  background: var(--tx3);
  border: none;
  cursor: pointer;
  position: relative;
  flex-shrink: 0;
  transition: background 0.2s;
}
.tog.on { background: var(--p); }
.tog::after {
  content: '';
  position: absolute;
  top: calc(0.1875rem * var(--scale)); left: calc(0.1875rem * var(--scale)); /* 3px */
  width: calc(1.375rem * var(--scale)); /* 22px */
  height: calc(1.375rem * var(--scale));
  border-radius: 50%;
  background: #fff;
  box-shadow: 0 calc(0.0625rem * var(--scale)) calc(0.25rem * var(--scale)) rgba(0, 0, 0, 0.25); /* 1px 4px */
  transition: transform 0.2s;
}
.tog.on::after { transform: translateX(calc(1.25rem * var(--scale))); } /* 20px */

.cgrid { display: flex; gap: calc(0.5rem * var(--scale)); flex-wrap: wrap; } /* 8px */
.csw {
  width: calc(2rem * var(--scale)); /* 32px */
  height: calc(2rem * var(--scale));
  border-radius: 50%;
  cursor: pointer;
  border: 3px solid transparent;
  transition: transform var(--tr), border-color var(--tr);
}
.csw:hover { transform: scale(1.15); }
.csw.on    { border-color: var(--tx); transform: scale(1.1); }

/* =============================================================
   19. MODAL LOGO
============================================================= */
.modal {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0, 0, 0, 0.8);
  z-index: 1000;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
}
.modal img {
  max-width: 80%;
  max-height: 80%;
  border-radius: calc(1rem * var(--scale)); /* 16px */
  box-shadow: var(--sh-lg);
  animation: fadeIn 0.2s;
}
@keyframes fadeIn {
  from { opacity: 0; transform: scale(0.9); }
  to   { opacity: 1; transform: scale(1); }
}

/* =============================================================
   20. SNACKBAR
============================================================= */
#snk {
  position: fixed;
  bottom: calc(3.75rem * var(--scale) + 4.875rem * var(--scale)); /* 60px + 78px */
  left: 50%;
  transform: translateX(-50%) translateY(calc(0.625rem * var(--scale))); /* 10px */
  background: var(--tx);
  color: var(--bg);
  padding: calc(0.625rem * var(--scale)) calc(1.125rem * var(--scale)); /* 10px 18px */
  border-radius: calc(0.625rem * var(--scale)); /* 10px */
  font-size: calc(0.875rem * var(--scale)); /* 14px */
  font-weight: 500;
  z-index: 300;
  opacity: 0;
  pointer-events: none;
  white-space: nowrap;
  transition: opacity 0.2s, transform 0.2s;
}
#snk.on { opacity: 1; pointer-events: all; transform: translateX(-50%) translateY(0); }

/* =============================================================
   21. ANIMATIONS
============================================================= */
@keyframes slideIn {
  from { opacity: 0; transform: translateY(calc(0.375rem * var(--scale))); } /* 6px */
  to   { opacity: 1; transform: translateY(0); }
}

@keyframes pulse {
  0%,100% { box-shadow: 0 calc(0.25rem * var(--scale)) calc(1.125rem * var(--scale)) color-mix(in srgb, var(--p) 45%, transparent); } /* 4px 18px */
  50%     { box-shadow: 0 calc(0.25rem * var(--scale)) calc(1.75rem * var(--scale)) color-mix(in srgb, var(--p) 80%, transparent); } /* 28px */
}

@keyframes checkBounce {
  0%   { transform: scale(1); }
  40%  { transform: scale(1.18); }
  70%  { transform: scale(0.92); }
  100% { transform: scale(1); }
}
.icheck.on { animation: checkBounce 0.25s ease-out; }

/* =============================================================
/* Effet de zoom pour le QR code
============================================================= */
#helpQrCode {
  transition: transform 0.2s ease-out;
  will-change: transform;
  transform-origin: center center;
  position: relative;
  z-index: 1;
}
#helpQrCode.zoomed {
  z-index: 10; /* pour que l'image passe au-dessus du contenu quand elle est agrandie */
}

/* =============================================================
   22. RESPONSIVE (≥ 640px)
============================================================= */
@media (min-width: 640px) {
  .lgrid { grid-template-columns: repeat(3, 1fr); }

  #fab { right: calc(1.5rem * var(--scale)); bottom: calc(3.75rem * var(--scale) + 1.25rem * var(--scale)); } /* 24px 20px */

  .sheet {
    max-width: 480px;
    left: 50%;
    transform: translateX(-50%) translateY(100%);
  }
  .sheet.on { transform: translateX(-50%) translateY(0); }

  #content {
    max-width: 640px;
    left: 50%;
    transform: translateX(-50%);
    right: auto;
    width: 100%;
  }

  #hdr, #nav {
    max-width: 640px;
    left: 50%;
    transform: translateX(-50%);
    right: auto;
    width: 100%;
  }
}

/* =============================================================
   Classes de taille d'affichage
============================================================= */
.size-xs { --scale: 0.8; }
.size-sm { --scale: 0.9; }
.size-md { --scale: 1; }
.size-lg { --scale: 1.2; }
.size-xl { --scale: 1.5; }

/* Ajustements spécifiques pour les icônes dans les boutons (pour être sûr qu'elles suivent) */
button svg,
button img {
  width: 1.25em;
  height: 1.25em;
}
/* Mais pour les très petites tailles, on peut les réduire un peu plus */
.size-xs button svg,
.size-xs button img {
  width: 1em;
  height: 1em;
}
/* Pour les très grandes tailles, on peut les augmenter */
.size-xl button svg,
.size-xl button img {
  width: 1.5em;
  height: 1.5em;
}

/* =============================================================
   QR code modal
============================================================= */
#qrModal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.8);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 10000; /* valeur plus élevée pour être sûr */
}

#qrModal img {
  max-width: 80%;
  max-height: 80%;
  min-width: 200px;   /* garantit une taille minimale */
  min-height: 200px;
  background: white;
  padding: 1.25rem;   /* 20px */
  border-radius: 1.25rem; /* 20px */
  box-sizing: border-box;
  object-fit: contain;
}